<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NAAC Criteria-wise Data Collection Portal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }

        .logo h1 {
            color: #2d3748;
            font-size: 24px;
            font-weight: 600;
        }

        .nav-tabs {
            display: flex;
            gap: 1rem;
        }

        .tab-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            background: transparent;
            color: #4a5568;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
        }

        .tab-btn.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .tab-btn:hover:not(.active) {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        .main-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.5s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: linear-gradient(135deg, #ffffff 0%, #f7fafc 100%);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid rgba(102, 126, 234, 0.1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
            border-color: rgba(102, 126, 234, 0.3);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: #4a5568;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .criteria-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .criteria-card {
            background: linear-gradient(135deg, #ffffff 0%, #f7fafc 100%);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid rgba(102, 126, 234, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .criteria-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
            border-color: rgba(102, 126, 234, 0.3);
        }

        .criteria-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .criteria-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .criteria-1 { background: linear-gradient(45deg, #ff6b6b, #ee5a24); }
        .criteria-2 { background: linear-gradient(45deg, #4ecdc4, #00b894); }
        .criteria-3 { background: linear-gradient(45deg, #45b7d1, #2d98da); }
        .criteria-4 { background: linear-gradient(45deg, #f7b731, #f39c12); }
        .criteria-5 { background: linear-gradient(45deg, #5f27cd, #8e44ad); }
        .criteria-6 { background: linear-gradient(45deg, #00a8ff, #3742fa); }
        .criteria-7 { background: linear-gradient(45deg, #2ed573, #27ae60); }

        .criteria-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2d3748;
        }

        .criteria-desc {
            color: #718096;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 0.8rem;
            color: #4a5568;
            text-align: right;
        }

        .form-container {
            background: linear-gradient(135deg, #ffffff 0%, #f7fafc 100%);
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .form-section {
            margin-bottom: 2rem;
        }

        .form-section h3 {
            color: #2d3748;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid rgba(102, 126, 234, 0.1);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #4a5568;
        }

        input, select, textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .file-upload {
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }

        .file-upload input {
            display: none;
        }

        .btn {
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: #cbd5e0;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .data-table th,
        .data-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .data-table th {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
        }

        .data-table tr:hover {
            background: #f7fafc;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 15px;
            padding: 2rem;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #718096;
        }

        .success-message,
        .error-message {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
        }

        .success-message {
            background: #c6f6d5;
            color: #22543d;
            border: 1px solid #9ae6b4;
        }

        .error-message {
            background: #fed7d7;
            color: #742a2a;
            border: 1px solid #fc8181;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-tabs {
                flex-wrap: wrap;
                justify-content: center;
            }

            .main-container {
                padding: 0 1rem;
            }

            .criteria-grid,
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">N</div>
                <h1>NAAC Data Collection Portal</h1>
            </div>
            <nav class="nav-tabs">
                <button class="tab-btn active" onclick="switchTab('dashboard')">Dashboard</button>
                <button class="tab-btn" onclick="switchTab('data-entry')">Data Entry</button>
                <button class="tab-btn" onclick="switchTab('reports')">Reports</button>
                <button class="tab-btn" onclick="switchTab('settings')">Settings</button>
            </nav>
        </div>
    </header>

    <main class="main-container">
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="dashboard-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-entries">0</div>
                    <div class="stat-label">Total Entries</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="completed-criteria">0/7</div>
                    <div class="stat-label">Completed Criteria</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="overall-progress">0%</div>
                    <div class="stat-label">Overall Progress</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="last-updated">Never</div>
                    <div class="stat-label">Last Updated</div>
                </div>
            </div>

            <div class="criteria-grid">
                <div class="criteria-card" onclick="openCriteriaModal(1)">
                    <div class="criteria-header">
                        <div class="criteria-icon criteria-1">1</div>
                        <div class="criteria-title">Curricular Aspects</div>
                    </div>
                    <div class="criteria-desc">Curriculum planning, implementation, and enrichment</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%" data-criteria="1"></div>
                    </div>
                    <div class="progress-text">0% Complete</div>
                </div>

                <div class="criteria-card" onclick="openCriteriaModal(2)">
                    <div class="criteria-header">
                        <div class="criteria-icon criteria-2">2</div>
                        <div class="criteria-title">Teaching-Learning & Evaluation</div>
                    </div>
                    <div class="criteria-desc">Student enrollment, teaching-learning processes, and evaluation</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%" data-criteria="2"></div>
                    </div>
                    <div class="progress-text">0% Complete</div>
                </div>

                <div class="criteria-card" onclick="openCriteriaModal(3)">
                    <div class="criteria-header">
                        <div class="criteria-icon criteria-3">3</div>
                        <div class="criteria-title">Research, Innovations & Extension</div>
                    </div>
                    <div class="criteria-desc">Research promotion, resource mobilization, and extension activities</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%" data-criteria="3"></div>
                    </div>
                    <div class="progress-text">0% Complete</div>
                </div>

                <div class="criteria-card" onclick="openCriteriaModal(4)">
                    <div class="criteria-header">
                        <div class="criteria-icon criteria-4">4</div>
                        <div class="criteria-title">Infrastructure & Learning Resources</div>
                    </div>
                    <div class="criteria-desc">Physical facilities, library, and ICT infrastructure</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%" data-criteria="4"></div>
                    </div>
                    <div class="progress-text">0% Complete</div>
                </div>

                <div class="criteria-card" onclick="openCriteriaModal(5)">
                    <div class="criteria-header">
                        <div class="criteria-icon criteria-5">5</div>
                        <div class="criteria-title">Student Support & Progression</div>
                    </div>
                    <div class="criteria-desc">Student support services and progression tracking</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%" data-criteria="5"></div>
                    </div>
                    <div class="progress-text">0% Complete</div>
                </div>

                <div class="criteria-card" onclick="openCriteriaModal(6)">
                    <div class="criteria-header">
                        <div class="criteria-icon criteria-6">6</div>
                        <div class="criteria-title">Governance, Leadership & Management</div>
                    </div>
                    <div class="criteria-desc">Institutional governance, leadership quality, and management</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%" data-criteria="6"></div>
                    </div>
                    <div class="progress-text">0% Complete</div>
                </div>

                <div class="criteria-card" onclick="openCriteriaModal(7)">
                    <div class="criteria-header">
                        <div class="criteria-icon criteria-7">7</div>
                        <div class="criteria-title">Institutional Values & Best Practices</div>
                    </div>
                    <div class="criteria-desc">Environmental consciousness, values, and best practices</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%" data-criteria="7"></div>
                    </div>
                    <div class="progress-text">0% Complete</div>
                </div>
            </div>
        </div>

        <!-- Data Entry Tab -->
        <div id="data-entry" class="tab-content">
            <div class="form-container">
                <h2>NAAC Data Entry Form</h2>
                <div class="success-message" id="success-message"></div>
                <div class="error-message" id="error-message"></div>
                
                <form id="naac-form">
                    <div class="form-section">
                        <h3>Institution Information</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="institution-name">Institution Name *</label>
                                <input type="text" id="institution-name" name="institutionName" required>
                            </div>
                            <div class="form-group">
                                <label for="naac-id">NAAC ID</label>
                                <input type="text" id="naac-id" name="naacId">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="criteria-select">Select Criteria *</label>
                                <select id="criteria-select" name="criteria" required>
                                    <option value="">Select a criteria</option>
                                    <option value="1">Criteria 1: Curricular Aspects</option>
                                    <option value="2">Criteria 2: Teaching-Learning & Evaluation</option>
                                    <option value="3">Criteria 3: Research, Innovations & Extension</option>
                                    <option value="4">Criteria 4: Infrastructure & Learning Resources</option>
                                    <option value="5">Criteria 5: Student Support & Progression</option>
                                    <option value="6">Criteria 6: Governance, Leadership & Management</option>
                                    <option value="7">Criteria 7: Institutional Values & Best Practices</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="academic-year">Academic Year *</label>
                                <select id="academic-year" name="academicYear" required>
                                    <option value="">Select year</option>
                                    <option value="2023-24">2023-24</option>
                                    <option value="2022-23">2022-23</option>
                                    <option value="2021-22">2021-22</option>
                                    <option value="2020-21">2020-21</option>
                                    <option value="2019-20">2019-20</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Quantitative Data</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="student-strength">Total Student Strength</label>
                                <input type="number" id="student-strength" name="studentStrength" min="0">
                            </div>
                            <div class="form-group">
                                <label for="faculty-count">Total Faculty Count</label>
                                <input type="number" id="faculty-count" name="facultyCount" min="0">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="programs-offered">Programs Offered</label>
                                <input type="number" id="programs-offered" name="programsOffered" min="0">
                            </div>
                            <div class="form-group">
                                <label for="budget-allocation">Budget Allocation (in Lakhs)</label>
                                <input type="number" id="budget-allocation" name="budgetAllocation" min="0" step="0.01">
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Qualitative Information</h3>
                        <div class="form-group">
                            <label for="description">Detailed Description *</label>
                            <textarea id="description" name="description" placeholder="Provide detailed information about the selected criteria..." required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="best-practices">Best Practices</label>
                            <textarea id="best-practices" name="bestPractices" placeholder="Describe any best practices implemented..."></textarea>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Supporting Documents</h3>
                        <div class="form-group">
                            <label>Upload Documents</label>
                            <div class="file-upload" onclick="document.getElementById('file-input').click()">
                                <input type="file" id="file-input" multiple accept=".pdf,.doc,.docx,.xlsx,.jpg,.png">
                                <div>üìé Click to upload files or drag and drop</div>
                                <small>Supported formats: PDF, DOC, DOCX, XLSX, JPG, PNG</small>
                            </div>
                            <div id="file-list"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">üíæ Save Data</button>
                        <button type="button" class="btn btn-secondary" onclick="clearForm()">üîÑ Clear Form</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reports" class="tab-content">
            <div class="form-container">
                <h2>NAAC Data Reports</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="report-criteria">Filter by Criteria</label>
                        <select id="report-criteria">
                            <option value="">All Criteria</option>
                            <option value="1">Criteria 1: Curricular Aspects</option>
                            <option value="2">Criteria 2: Teaching-Learning & Evaluation</option>
                            <option value="3">Criteria 3: Research, Innovations & Extension</option>
                            <option value="4">Criteria 4: Infrastructure & Learning Resources</option>
                            <option value="5">Criteria 5: Student Support & Progression</option>
                            <option value="6">Criteria 6: Governance, Leadership & Management</option>
                            <option value="7">Criteria 7: Institutional Values & Best Practices</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="report-year">Filter by Year</label>
                        <select id="report-year">
                            <option value="">All Years</option>
                            <option value="2023-24">2023-24</option>
                            <option value="2022-23">2022-23</option>
                            <option value="2021-22">2021-22</option>
                            <option value="2020-21">2020-21</option>
                            <option value="2019-20">2019-20</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <button class="btn btn-primary" onclick="generateReport()">üìä Generate Report</button>
                    <button class="btn btn-secondary" onclick="exportData()">üì• Export Data</button>
                </div>
                
                <table class="data-table" id="report-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Institution</th>
                            <th>Criteria</th>
                            <th>Academic Year</th>
                            <th>Student Strength</th>
                            <th>Faculty Count</th>
                            <th>Date Added</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="report-tbody">
                        <tr>
                            <td colspan="8" style="text-align: center; padding: 2rem; color: #718096;">
                                No data available. Please add some entries first.
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="form-container">
                <h2>Portal Settings</h2>
                
                <div class="form-section">
                    <h3>Data Management</h3>
                    <div class="form-group">
                        <button class="btn btn-secondary" onclick="clearAllData()">üóëÔ∏è Clear All Data</button>
                        <button class="btn btn-secondary" onclick="importData()">üì§ Import Data</button>
                        <button class="btn btn-primary" onclick="exportAllData()">üì• Export All Data</button>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Institution Settings</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="default-institution">Default Institution Name</label>
                            <input type="text" id="default-institution" placeholder="Enter default institution name">
                        </div>
                        <div class="form-group">
                            <label for="default-naac-id">Default NAAC ID</label>
                            <input type="text" id="default-naac-id" placeholder="Enter default NAAC ID">
                        </div>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-primary" onclick="saveSettings()">üíæ Save Settings</button>
                    </div>
                </div>

                <div class="form-section">
                    <h3>About</h3>
                    <p style="color: #718096; line-height: 1.6;">
                        NAAC Criteria-wise Data Collection Portal v1.0<br>
                        Developed for institutional data collection and NAAC accreditation preparation.<br>
                        This portal helps institutions organize and manage data across all seven NAAC criteria.
                    </p>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal for Criteria Details -->
    <div id="criteria-modal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeCriteriaModal()">√ó</button>
            <div id="modal-content"></div>
        </div>
    </div>

    <script>
        // Application state
        let naacData = JSON.parse(localStorage.getItem('naacData') || '[]');
        let settings = JSON.parse(localStorage.getItem('naacSettings') || '{}');

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboard();
            loadSettings();
            setupEventListeners();
        });

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            // Remove active class from all tab buttons
            const tabButtons = document.querySelectorAll('.tab-btn');
            tabButtons.forEach(btn => btn.classList.remove('active'));

            // Show selected tab content
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked tab button
            event.target.classList.add('active');

            // Update reports if reports tab is selected
            if (tabName === 'reports') {
                generateReport();
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Form submission
            document.getElementById('naac-form').addEventListener('submit', handleFormSubmit);

            // File input change
            document.getElementById('file-input').addEventListener('change', handleFileSelect);

            // Report filters
            document.getElementById('report-criteria').addEventListener('change', generateReport);
            document.getElementById('report-year').addEventListener('change', generateReport);
        }

        // Handle form submission
        function handleFormSubmit(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData.entries());
            
            // Add timestamp and ID
            data.id = Date.now();
            data.dateAdded = new Date().toLocaleDateString();
            data.files = Array.from(document.getElementById('file-input').files).map(file => file.name);
            
            // Validate required fields
            if (!data.institutionName || !data.criteria || !data.academicYear || !data.description) {
                showMessage('Please fill in all required fields.', 'error');
                return;
            }
            
            // Save data
            naacData.push(data);
            localStorage.setItem('naacData', JSON.stringify(naacData));
            
            showMessage('Data saved successfully!', 'success');
            updateDashboard();
            clearForm();
        }

        // Handle file selection
        function handleFileSelect(event) {
            const files = event.target.files;
            const fileList = document.getElementById('file-list');
            
            fileList.innerHTML = '';
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const fileItem = document.createElement('div');
                fileItem.style.cssText = 'margin-top: 0.5rem; padding: 0.5rem; background: #f7fafc; border-radius: 4px; font-size: 0.9rem;';
                fileItem.textContent = `üìÑ ${file.name} (${(file.size / 1024).toFixed(1)} KB)`;
                fileList.appendChild(fileItem);
            }
        }

        // Update dashboard statistics and progress
        function updateDashboard() {
            const totalEntries = naacData.length;
            const criteriaProgress = calculateCriteriaProgress();
            const completedCriteria = Object.values(criteriaProgress).filter(p => p > 0).length;
            const overallProgress = Math.round(Object.values(criteriaProgress).reduce((a, b) => a + b, 0) / 7);
            const lastUpdated = naacData.length > 0 ? 
                new Date(Math.max(...naacData.map(d => new Date(d.dateAdded)))).toLocaleDateString() : 'Never';

            // Update dashboard stats
            document.getElementById('total-entries').textContent = totalEntries;
            document.getElementById('completed-criteria').textContent = `${completedCriteria}/7`;
            document.getElementById('overall-progress').textContent = `${overallProgress}%`;
            document.getElementById('last-updated').textContent = lastUpdated;

            // Update criteria progress bars
            for (let i = 1; i <= 7; i++) {
                const progressFill = document.querySelector(`[data-criteria="${i}"]`);
                const progressText = progressFill.parentElement.nextElementSibling;
                const progress = criteriaProgress[i] || 0;
                
                progressFill.style.width = `${progress}%`;
                progressText.textContent = `${progress}% Complete`;
            }
        }

        // Calculate progress for each criteria
        function calculateCriteriaProgress() {
            const progress = {};
            
            for (let i = 1; i <= 7; i++) {
                const entriesForCriteria = naacData.filter(d => d.criteria == i);
                // Simple progress calculation based on number of entries
                progress[i] = Math.min(entriesForCriteria.length * 25, 100);
            }
            
            return progress;
        }

        // Open criteria modal with detailed information
        function openCriteriaModal(criteriaNumber) {
            const criteriaDetails = {
                1: {
                    title: "Curricular Aspects",
                    description: "This criteria focuses on curriculum planning and implementation, including program design, syllabus development, and academic flexibility.",
                    keyIndicators: [
                        "Curriculum Planning and Implementation",
                        "Academic Flexibility",
                        "Curriculum Enrichment",
                        "Feedback System"
                    ]
                },
                2: {
                    title: "Teaching-Learning and Evaluation",
                    description: "Covers student enrollment, teaching-learning process, teacher profile, and evaluation processes.",
                    keyIndicators: [
                        "Student Enrollment and Profile",
                        "Catering to Student Diversity",
                        "Teaching-Learning Process",
                        "Teacher Profile and Quality"
                    ]
                },
                3: {
                    title: "Research, Innovations and Extension",
                    description: "Focuses on promoting research culture, resource mobilization, research facilities, and extension activities.",
                    keyIndicators: [
                        "Resource Mobilization for Research",
                        "Innovation Ecosystem",
                        "Research Publications",
                        "Extension Activities"
                    ]
                },
                4: {
                    title: "Infrastructure and Learning Resources",
                    description: "Deals with physical and academic support facilities including library, ICT, and campus infrastructure.",
                    keyIndicators: [
                        "Physical Facilities",
                        "Library as Learning Resource",
                        "IT Infrastructure",
                        "Maintenance of Campus Infrastructure"
                    ]
                },
                5: {
                    title: "Student Support and Progression",
                    description: "Covers student support services, guidance, soft skills development, and progression tracking.",
                    keyIndicators: [
                        "Student Support",
                        "Student Progression",
                        "Student Participation",
                        "Alumni Engagement"
                    ]
                },
                6: {
                    title: "Governance, Leadership and Management",
                    description: "Focuses on institutional governance, leadership quality, faculty empowerment, and financial management.",
                    keyIndicators: [
                        "Institutional Vision and Leadership",
                        "Strategy Development",
                        "Faculty Empowerment Strategies",
                        "Financial Management"
                    ]
                },
                7: {
                    title: "Institutional Values and Best Practices",
                    description: "Emphasizes environmental consciousness, institutional values, and best practices implementation.",
                    keyIndicators: [
                        "Institutional Values",
                        "Best Practices",
                        "Institutional Distinctiveness",
                        "Environmental Consciousness"
                    ]
                }
            };

            const criteria = criteriaDetails[criteriaNumber];
            const entriesCount = naacData.filter(d => d.criteria == criteriaNumber).length;
            
            const modalContent = `
                <h2>Criteria ${criteriaNumber}: ${criteria.title}</h2>
                <p style="margin-bottom: 1.5rem; color: #4a5568; line-height: 1.6;">${criteria.description}</p>
                
                <h3 style="color: #2d3748; margin-bottom: 1rem;">Key Indicators:</h3>
                <ul style="margin-bottom: 1.5rem; padding-left: 1.5rem;">
                    ${criteria.keyIndicators.map(indicator => `<li style="margin-bottom: 0.5rem;">${indicator}</li>`).join('')}
                </ul>
                
                <div style="background: #f7fafc; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <strong>Current Status:</strong> ${entriesCount} entries recorded
                </div>
                
                <button class="btn btn-primary" onclick="switchTab('data-entry'); closeCriteriaModal(); document.getElementById('criteria-select').value='${criteriaNumber}';">
                    üìù Add Data for This Criteria
                </button>
            `;
            
            document.getElementById('modal-content').innerHTML = modalContent;
            document.getElementById('criteria-modal').style.display = 'block';
        }

        // Close criteria modal
        function closeCriteriaModal() {
            document.getElementById('criteria-modal').style.display = 'none';
        }

        // Generate report based on filters
        function generateReport() {
            const criteriaFilter = document.getElementById('report-criteria').value;
            const yearFilter = document.getElementById('report-year').value;
            
            let filteredData = naacData;
            
            if (criteriaFilter) {
                filteredData = filteredData.filter(d => d.criteria == criteriaFilter);
            }
            
            if (yearFilter) {
                filteredData = filteredData.filter(d => d.academicYear === yearFilter);
            }
            
            const tbody = document.getElementById('report-tbody');
            
            if (filteredData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 2rem; color: #718096;">
                            No data matches the selected filters.
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = filteredData.map(data => `
                <tr>
                    <td>${data.id}</td>
                    <td>${data.institutionName}</td>
                    <td>Criteria ${data.criteria}</td>
                    <td>${data.academicYear}</td>
                    <td>${data.studentStrength || 'N/A'}</td>
                    <td>${data.facultyCount || 'N/A'}</td>
                    <td>${data.dateAdded}</td>
                    <td>
                        <button class="btn btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;" onclick="viewEntry(${data.id})">üëÅÔ∏è View</button>
                        <button class="btn btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; margin-left: 0.25rem;" onclick="deleteEntry(${data.id})">üóëÔ∏è Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        // View individual entry
        function viewEntry(id) {
            const entry = naacData.find(d => d.id === id);
            if (!entry) return;
            
            const modalContent = `
                <h2>Entry Details</h2>
                <div style="background: #f7fafc; padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem;">
                    <p><strong>Institution:</strong> ${entry.institutionName}</p>
                    <p><strong>NAAC ID:</strong> ${entry.naacId || 'N/A'}</p>
                    <p><strong>Criteria:</strong> ${entry.criteria}</p>
                    <p><strong>Academic Year:</strong> ${entry.academicYear}</p>
                    <p><strong>Student Strength:</strong> ${entry.studentStrength || 'N/A'}</p>
                    <p><strong>Faculty Count:</strong> ${entry.facultyCount || 'N/A'}</p>
                    <p><strong>Programs Offered:</strong> ${entry.programsOffered || 'N/A'}</p>
                    <p><strong>Budget Allocation:</strong> ${entry.budgetAllocation ? '‚Çπ' + entry.budgetAllocation + ' Lakhs' : 'N/A'}</p>
                </div>
                <div style="margin-bottom: 1rem;">
                    <h4>Description:</h4>
                    <p style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid #e2e8f0;">${entry.description}</p>
                </div>
                ${entry.bestPractices ? `
                <div style="margin-bottom: 1rem;">
                    <h4>Best Practices:</h4>
                    <p style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid #e2e8f0;">${entry.bestPractices}</p>
                </div>
                ` : ''}
                ${entry.files && entry.files.length > 0 ? `
                <div>
                    <h4>Attached Files:</h4>
                    <ul>${entry.files.map(file => `<li>${file}</li>`).join('')}</ul>
                </div>
                ` : ''}
            `;
            
            document.getElementById('modal-content').innerHTML = modalContent;
            document.getElementById('criteria-modal').style.display = 'block';
        }

        // Delete entry
        function deleteEntry(id) {
            if (confirm('Are you sure you want to delete this entry?')) {
                naacData = naacData.filter(d => d.id !== id);
                localStorage.setItem('naacData', JSON.stringify(naacData));
                generateReport();
                updateDashboard();
                showMessage('Entry deleted successfully!', 'success');
            }
        }

        // Export data functionality
        function exportData() {
            const criteriaFilter = document.getElementById('report-criteria').value;
            const yearFilter = document.getElementById('report-year').value;
            
            let filteredData = naacData;
            
            if (criteriaFilter) {
                filteredData = filteredData.filter(d => d.criteria == criteriaFilter);
            }
            
            if (yearFilter) {
                filteredData = filteredData.filter(d => d.academicYear === yearFilter);
            }
            
            if (filteredData.length === 0) {
                showMessage('No data to export with current filters.', 'error');
                return;
            }
            
            const csvContent = convertToCSV(filteredData);
            downloadCSV(csvContent, 'naac_data_export.csv');
            showMessage('Data exported successfully!', 'success');
        }

        // Export all data
        function exportAllData() {
            if (naacData.length === 0) {
                showMessage('No data to export.', 'error');
                return;
            }
            
            const csvContent = convertToCSV(naacData);
            downloadCSV(csvContent, 'naac_all_data_export.csv');
            showMessage('All data exported successfully!', 'success');
        }

        // Convert data to CSV format
        function convertToCSV(data) {
            const headers = [
                'ID', 'Institution Name', 'NAAC ID', 'Criteria', 'Academic Year',
                'Student Strength', 'Faculty Count', 'Programs Offered', 'Budget Allocation',
                'Description', 'Best Practices', 'Date Added'
            ];
            
            const csvRows = [headers.join(',')];
            
            data.forEach(row => {
                const values = [
                    row.id,
                    `"${row.institutionName}"`,
                    `"${row.naacId || ''}"`,
                    row.criteria,
                    row.academicYear,
                    row.studentStrength || '',
                    row.facultyCount || '',
                    row.programsOffered || '',
                    row.budgetAllocation || '',
                    `"${(row.description || '').replace(/"/g, '""')}"`,
                    `"${(row.bestPractices || '').replace(/"/g, '""')}"`,
                    row.dateAdded
                ];
                csvRows.push(values.join(','));
            });
            
            return csvRows.join('\n');
        }

        // Download CSV file
        function downloadCSV(csvContent, filename) {
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }

        // Clear form
        function clearForm() {
            document.getElementById('naac-form').reset();
            document.getElementById('file-list').innerHTML = '';
        }

        // Show success/error messages
        function showMessage(message, type) {
            const messageElement = document.getElementById(type + '-message');
            messageElement.textContent = message;
            messageElement.style.display = 'block';
            
            setTimeout(() => {
                messageElement.style.display = 'none';
            }, 5000);
        }

        // Settings functions
        function saveSettings() {
            const defaultInstitution = document.getElementById('default-institution').value;
            const defaultNaacId = document.getElementById('default-naac-id').value;
            
            settings.defaultInstitution = defaultInstitution;
            settings.defaultNaacId = defaultNaacId;
            
            localStorage.setItem('naacSettings', JSON.stringify(settings));
            
            // Apply settings to form
            if (defaultInstitution) {
                document.getElementById('institution-name').value = defaultInstitution;
            }
            if (defaultNaacId) {
                document.getElementById('naac-id').value = defaultNaacId;
            }
            
            showMessage('Settings saved successfully!', 'success');
        }

        function loadSettings() {
            if (settings.defaultInstitution) {
                document.getElementById('default-institution').value = settings.defaultInstitution;
                document.getElementById('institution-name').value = settings.defaultInstitution;
            }
            if (settings.defaultNaacId) {
                document.getElementById('default-naac-id').value = settings.defaultNaacId;
                document.getElementById('naac-id').value = settings.defaultNaacId;
            }
        }

        function clearAllData() {
            if (confirm('Are you sure you want to clear all data? This action cannot be undone.')) {
                naacData = [];
                localStorage.removeItem('naacData');
                updateDashboard();
                generateReport();
                showMessage('All data cleared successfully!', 'success');
            }
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.csv';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const csv = e.target.result;
                            const lines = csv.split('\n');
                            const headers = lines[0].split(',');
                            
                            for (let i = 1; i < lines.length; i++) {
                                if (lines[i].trim()) {
                                    const values = lines[i].split(',');
                                    const entry = {
                                        id: Date.now() + i,
                                        institutionName: values[1]?.replace(/"/g, '') || '',
                                        naacId: values[2]?.replace(/"/g, '') || '',
                                        criteria: values[3] || '',
                                        academicYear: values[4] || '',
                                        studentStrength: values[5] || '',
                                        facultyCount: values[6] || '',
                                        programsOffered: values[7] || '',
                                        budgetAllocation: values[8] || '',
                                        description: values[9]?.replace(/"/g, '') || '',
                                        bestPractices: values[10]?.replace(/"/g, '') || '',
                                        dateAdded: new Date().toLocaleDateString(),
                                        files: []
                                    };
                                    naacData.push(entry);
                                }
                            }
                            
                            localStorage.setItem('naacData', JSON.stringify(naacData));
                            updateDashboard();
                            generateReport();
                            showMessage('Data imported successfully!', 'success');
                        } catch (error) {
                            showMessage('Error importing data. Please check the file format.', 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        // Close modal when clicking outside
        document.getElementById('criteria-modal').addEventListener('click', function(event) {
            if (event.target === this) {
                closeCriteriaModal();
            }
        });
    </script>
</body>
</html>